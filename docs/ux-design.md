# tmuxui モバイルUXデザイン方針

## 設計理念

**Less is More**: 画面サイズの制約を活かし、本質的な機能のみを直感的に配置する。
**モバイルファースト**: スマートフォンの小さい画面を前提に、タッチ操作に最適化。
**安全設計**: 操作ミスの防止を最優先。重要な操作には確認ステップを挿入。

---

## 1. ペイン一覧の表示方法

### 採用案: タブ式リスト + スクロール

```
┌─────────────────────────────┐
│  ◄ Back    [📊] [🔍] [⚙]   │ ← タブ（エージェント）
├─────────────────────────────┤
│  ▶ Agent1 (3 panes)         │
│  ├─ [main]                  │
│  ├─ [error]                 │
│  └─ [debug]                 │
│                             │
│  ▶ Agent2 (2 panes)         │
│  ├─ [terminal]              │
│  └─ [logs]                  │
│                             │
│  ▶ Agent3 (1 pane)          │
│  └─ [output]                │
│                             │
└─────────────────────────────┘
```

### 特徴
- **エージェント別のタブ**: トップレベルは複数エージェントの管理。タブで瞬時に切り替え
- **ツリー構造**: 各エージェント直下にペイン一覧。`▶/▼`で展開/折畳み
- **ペインタップで詳細表示**: リストからペインを選択すると詳細画面に遷移
- **視覚的階層**: インデント + アイコンで構造を明確化
- **スクロール対応**: ペイン数が多くても対応可能

### メリット
- 複数エージェント・複数ペインの構造が一目で理解できる
- タップターゲットが十分な大きさ（タッチエラー防止）
- スマホ縦型で全体を把握しやすい

---

## 2. 個別ペインの内容表示

### レイアウト

```
┌─────────────────────────────┐
│ ◄ [Agent1 - main]      🔄   │ ← ヘッダー（戻る、ペイン名、更新）
├─────────────────────────────┤
│                             │
│  $ npm run build            │
│  > Building modules...      │
│  ✓ Built successfully       │
│  $ _                        │
│                             │
│  [スクロール可能]            │
│                             │
├─────────────────────────────┤
│  [>] 権限許可依頼あり ⓘ    │ ← 通知バナー
│  [▼] 指示入力              │ ← 指示入力欄（折畳み）
└─────────────────────────────┘
```

### 特徴
- **ヘッダー**: 戻るボタン、ペイン情報、リアルタイム更新ボタン（手動更新）
- **コンテンツエリア**:
  - モノスペースフォント（ターミナル感）
  - 背景は濃いグレー/黒（ダークモード）
  - 適度な行間で読みやすさ確保
  - 上下スクロール対応
- **下部バナー**: 権限許可リクエストを画面左下の固定バナーで表示
- **折畳み式指示入力**: デフォルトは閉じた状態で、タップで展開

### リアルタイム更新の見せ方
- **非自動更新**: モバイルネットワークの消費を考慮し、自動更新ではなく手動更新（🔄ボタン）
- **更新アニメーション**: ボタンの回転アニメーションで更新中を表示
- **更新タイムスタンプ**: "最終更新: 12:34"を画面上部に表示

### フォント・色の工夫
```
背景: #1a1a1a (黒に近いグレー)
標準テキスト: #e0e0e0 (薄いグレー)
エラー: #ff6b6b (赤)
成功: #51cf66 (緑)
情報: #4dabf7 (青)
警告: #ffa94d (橙)
```

---

## 3. 権限許可ダイアログ

### ダイアログ UI

```
┌─────────────────────────────┐
│  ⚠️  権限許可が必要です      │ ← 明確なタイトル
├─────────────────────────────┤
│                             │
│  リクエスト内容:             │
│  実行コマンド:               │
│  $ npm test                 │
│                             │
│  実行エージェント:           │
│  test-runner                │
│                             │
│  実行箇所:                   │
│  /src/components/...        │
│                             │
├─────────────────────────────┤
│  ⏱️ 有効期限: 2分 47秒       │ ← タイムリミット表示
├─────────────────────────────┤
│  [  いいえ  ]  [  はい  ]   │ ← ボタン（左=否定、右=肯定）
└─────────────────────────────┘
```

### 特徴
- **大きいタップターゲット**: ボタン高さ 48px 以上
- **明確な内容表示**: コマンド、エージェント、実行箇所を分かりやすく
- **タイムリミット表示**: 有効期限をカウントダウン（オプション）
- **デフォルトフォーカス**: 「いいえ」ボタンにフォーカス（誤許可防止）
- **色分け**: 許可は緑、拒否は赤で視覚的に区別

### 誤タップ防止の工夫
- ボタン間に十分な間隔を設ける（最小 8px）
- フォーカス状態を視覚的に強調
- スワイプでダイアログを閉じる機能は NOT 提供（意図しない許可防止）

---

## 4. 指示入力 UI

### 指示入力フォーム

```
┌─────────────────────────────┐
│ ◄ [Agent1 - main]      🔄   │
├─────────────────────────────┤
│ $ npm run build             │
│ > Building...               │
│ ✓ Done                      │
│                             │
├─────────────────────────────┤
│ [▼] 指示を入力              │ ← 折畳み/展開トグル
├─────────────────────────────┤
│ プリセット:                  │
│ [再ビルド]  [テスト実行]     │
│ [ログ削除]  [カスタム...]   │
│                             │
│ カスタム指示:               │
│ ┌─────────────────────────┐ │
│ │ npm run test --watch    │ │ ← 入力フィールド
│ └─────────────────────────┘ │
│                             │
│ [送信]  [キャンセル]         │ ← ボタン
│                             │
└─────────────────────────────┘
```

### 特徴
- **プリセットコマンド**: よく使用するコマンドをボタン化
- **カスタム入力**: テキスト入力で任意のコマンド指定可能
- **初期状態は折畳み**: スマホ画面を効率的に使用
- **大きい入力フィールド**: スマホキーボード対応

### 送信前の確認
```
┌─────────────────────────────┐
│  コマンドを送信しますか？    │
│                             │
│  npm run test --watch       │ ← 確認内容
│                             │
│  [キャンセル]  [送信]       │
└─────────────────────────────┘
```
- **必須**: すべてのカスタム入力に送信確認を表示
- **プリセット**: よく使うものは確認スキップ可能（ただしユーザー設定で変更可能）

### 入力UI の工夫
- **自動フォーカス**: 入力フォーム展開時にキーボード自動表示
- **文字数制限**: 誤ったコマンド入力を防ぐため、最大 256 文字
- **サジェスト**: 以前入力したコマンド履歴を表示（オプション）

---

## 5. ナビゲーション

### 画面遷移フロー

```
┌─────────────────┐
│  ペイン一覧画面  │ ← ホーム
└────────┬────────┘
         │ (ペイン選択)
         ▼
┌─────────────────┐
│  ペイン詳細画面  │ ← メイン
└────────┬────────┘
         │ (戻るボタン or スワイプ)
         ▼
┌─────────────────┐
│  ペイン一覧画面  │ ← ホームに戻る
└─────────────────┘
```

### ナビゲーションパターン
- **タブ切り替え**: エージェント間の移動（ホーム画面）
- **リスト → 詳細**: ペイン一覧から詳細表示へ
- **戻る操作**: 詳細 → 一覧への戻り（ボタン or スワイプ）
- **権限許可ダイアログ**: すべての画面からアクセス可能（フローティング）

### 戻る操作の実装
- **戻るボタン**: ヘッダー左上に常設
- **スワイプジェスチャ**: 右スワイプで前の画面に戻る（iOS標準動作）
- **ハードウェア戻る**: Android ネイティブボタンも対応

---

## 6. 安全設計

### 操作ミス防止のための設計

#### a) 確認ダイアログ
- **権限許可**: 必須（デフォルト拒否）
- **コマンド送信**: 必須（特にカスタム入力）
- **ペイン削除**: 該当機能がある場合は必須

#### b) タップターゲットのサイズ
- **最小サイズ**: 48px × 48px （Apple HIG準拠）
- **ボタン間距離**: 最小 8px

#### c) 画面ロック機能（オプション）
- **長時間操作なし**: 5分後に自動ロック
- **ロック画面**: パスコード/生体認証で再度アクセス
- 誤操作防止 + セキュリティ向上

#### d) 誤送信防止
- **確認ダイアログ**: コマンド送信前に内容確認
- **送信ボタンの位置**: キャンセルボタンと十分距離を離す
- **キーボード自動クローズ**: 送信後に入力フォーム自動クローズ

#### e) セッション管理
- **タイムアウト**: 10分無操作でセッション終了
- **ログアウト**: 明示的なログアウトボタンを用意

### 危険な操作の制限
- **フルターミナルアクセス**: 提供しない（仕様上できない）
- **権限許可**: スマホから可能だが、詳細な内容確認を必須化
- **コマンド実行**: 事前に確認ダイアログを表示

---

## 7. ビジュアルデザイン

### カラースキーム（ダークモード）

| 要素 | 色 | 用途 |
|------|------|------|
| 背景 | #1a1a1a | 画面背景 |
| セカンダリ背景 | #2d2d2d | カード、入力フィールド |
| テキスト（標準） | #e0e0e0 | 本文 |
| テキスト（補助） | #999999 | 説明、タイムスタンプ |
| アクセント（青） | #4dabf7 | リンク、アクティブ要素 |
| 成功（緑） | #51cf66 | 成功メッセージ |
| エラー（赤） | #ff6b6b | エラーメッセージ |
| 警告（橙） | #ffa94d | 警告メッセージ |
| ボーダー | #404040 | 区切り線 |

### ターミナルらしい配色
- **黒基調**: CRT時代のターミナルをオマージュ
- **カラーコード**: ANSI 標準色に合わせて統一感を出す
- **モノスペースフォント**: `Menlo`, `Monaco`, `Courier New` を優先度順に使用

### レイアウト
- **セーフエリア対応**: iPhone のノッチ・ホームインジケータに対応
- **マージン**: 上下左右 16px （スマホ標準）
- **タイプグラフィ**:
  - ヘッダー: 18px, bold
  - 本文: 14px, regular
  - 補助: 12px, regular

### ダークモードのみ対応
- ライトモード未実装（バッテリー節約 + モバイルUXの統一性）

---

## 8. 通知

### 権限許可リクエスト通知

#### 画面内表示（推奨）
```
┌─────────────────────────────┐
│ ⚠️ 権限許可が必要です       │ ← 固定バナー（画面下部）
│ [詳細] [許可]  [拒否]      │
└─────────────────────────────┘
```

#### バナーの特徴
- **位置**: 画面下部に固定（フローティング）
- **自動非表示**: ユーザーが操作 or 有効期限切れで自動削除
- **色**: 黄色/橙系（警告）で目立つ
- **アクション**:
  - [詳細] → ダイアログを開く
  - [許可]/[拒否] → 即座に応答

#### プッシュ通知（オプション）
- モバイルOSのプッシュ通知を活用（ただしユーザー設定で変更可能）
- タイトル: "権限許可が必要です"
- 本文: "Agent1 が npm test の実行許可を待機中"
- タップで権限許可ダイアログを開く

### その他の通知
- **コマンド実行完了**: バナー + オプショナルプッシュ
- **エラー**: 画面内バナー（赤系）+ 音声フィードバック（オプション）
- **セッション有効期限**: 1分前に警告バナー表示

---

## 実装優先度

### フェーズ 1（MVP）
1. ペイン一覧表示（タブ + ツリー）
2. ペイン詳細表示（手動更新）
3. 権限許可ダイアログ
4. 指示入力フォーム + 確認ダイアログ

### フェーズ 2（改善）
5. 通知機能（画面内バナー）
6. スワイプナビゲーション
7. プリセットコマンド管理UI

### フェーズ 3（拡張）
8. プッシュ通知
9. セッションロック機能
10. コマンド履歴・サジェスト

---

## まとめ

本設計は以下の原則に基づいています：

✅ **モバイルファースト**: スマホの小さい画面を前提とした設計
✅ **安全第一**: 誤操作防止を最優先に確認ダイアログを多用
✅ **Less is More**: 必要最小限の機能に絞り込み、シンプルな画面構成
✅ **ターミナル感**: ダークモード + モノスペースで CLI ツールらしさを表現
✅ **スマホネイティブ**: タッチジェスチャ + ハードウェアボタンに対応

このUXデザインに基づいて、実装チームが開発を進めることで、外出先からでも安全かつ直感的に tmux セッションを管理できるモバイルアプリが実現できます。
